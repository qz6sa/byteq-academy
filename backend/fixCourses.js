require('dotenv').config();
const mongoose = require('mongoose');
const Course = require('./models/Course');
const Section = require('./models/Section');
const Lecture = require('./models/Lecture');

// Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGO_URI);
    console.log('âœ… MongoDB Connected');
  } catch (error) {
    console.error(`âŒ Error: ${error.message}`);
    process.exit(1);
  }
};

// Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ±Ø§Øª ÙˆØ¥ØµÙ„Ø§Ø­ slugs
const fixCourses = async () => {
  try {
    // Ø­Ø°Ù ÙƒÙ„ Ø´ÙŠØ¡
    await Lecture.deleteMany({});
    console.log('âœ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª');
    
    await Section.deleteMany({});
    console.log('âœ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…');
    
    await Course.deleteMany({});
    console.log('âœ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ±Ø§Øª');
    
    console.log('\nâœ¨ ØªÙ… ØªÙ†Ø¸ÙŠÙ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
    console.log('ðŸ‘‰ Ø§Ù„Ø¢Ù† ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…\n');
    
    process.exit(0);
  } catch (error) {
    console.error(`âŒ Ø®Ø·Ø£: ${error.message}`);
    process.exit(1);
  }
};

// ØªØ´ØºÙŠÙ„
connectDB().then(() => fixCourses());
